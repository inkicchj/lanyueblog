{% extends "base.html" %}

{% block title %}{{ web.name }}{% endblock title %}

{% block head %}
{{ super() }}
{% endblock head %}

{% block nav %}
{% include "component/nav.html" %}
{% endblock nav %}

{% block main %}
<div class="card" style="margin-top: 50px;">
    <div class="card-content">
        <div class="content">

            <div class="field">
                <label class="label">原密码</label>
                <div class="control">
                    <input class="input" type="password" placeholder="6-18位" value="" id="old-pwd">
                </div>
            </div>

            <div class="field">
                <label class="label">新密码</label>
                <div class="control">
                    <input class="input" type="password" placeholder="6-18位" value="" id="new-pwd">
                </div>
            </div>

            <div style="margin-top: 20px;">
                <button class="button is-success" onclick="update_password()">更改</button>
            </div>

        </div>

</div>
</div>
{% endblock main %}


{% block script %}
<script type="text/javascript">
    function update_password() {
        let old_pwd = document.getElementById("old-pwd").value;
        let new_pwd = document.getElementById("new-pwd").value;
        axios({
            method: 'post',
            url: '/user/edit/pwd',
            data: {
                old_pwd: old_pwd,
                new_pwd: new_pwd
            }
        }).then( res => {
            console.log(res)
            if (res.data.code == 200) {
                Qmsg.success(res.data.msg, {
                    timeout: 3000
                });
            }
            if (res.data.code == 410) {
                Qmsg.warning(res.data.msg, {
                    timeout: 3000
                });
            }
        })
    }
</script>
{% endblock script %}